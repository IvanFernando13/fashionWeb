<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Account - FS Fashion Marketplace</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    

</head>
<body class="brands-page">

    <header class="header">
        <div class="header-container">
            <div class="logo">
                <a href="index.html" class="logo-link">
                    <span class="logo-text">FS</span>
                </a>
            </div>
            <nav class="navigation">
                <ul class="nav-links">
                    <li><a href="categoryPage.html">Shop</a></li>
                    <li><a href="brandsPage.html">Brands</a></li>
                    <li><a href="searchPage.html">Search</a></li>
                    <li><a href="inspirationPage.html">Inspiration</a></li>
                    <li><a href="games.html">Games</a></li>
                </ul>
            </nav>
            <div class="right-actions">
                <a href="bagPage.html" class="bag-link">Bag <span id="cart-count"></span></a>
                <div class="utility-links" id="header-utility-links">
                    <a href="accountPage.html">Account</a>
                </div>
            </div>
        </div>
    </header>

    <main class="account-page-container">
        <div class="auth-tabs">
            <button class="tab-btn active" data-tab="signIn">Sign In</button>
            <button class="tab-btn" data-tab="createAccount">Create Account</button>
        </div>
        
        <div id="authError" class="auth-error"></div>

        <section id="signIn" class="auth-form-section active">
            <form action="#" method="post" id="signInForm">
                <div class="form-group" id="signInEmailGroup">
                    <label for="signInEmail" class="required">Email</label>
                    <input type="email" id="signInEmail" name="email" required>
                    <p class="error-message">This field is required.</p>
                </div>
                <div class="form-group" id="signInPasswordGroup">
                    <label for="signInPassword" class="required">Password</label>
                    <input type="password" id="signInPassword" name="password" required>
                    <p class="error-message">This field is required.</p>
                </div>
                <button type="submit" class="submit-btn">Sign In</button>
            </form>
        </section>

        <section id="createAccount" class="auth-form-section">
            <form action="#" method="post" id="createAccountForm">
                <div class="form-group" id="createUsernameGroup">
                    <label for="createUsername" class="required">Username</label>
                    <input type="text" id="createUsername" name="username" required>
                    <p class="error-message">This field is required.</p>
                </div>
                <div class="form-group" id="createEmailGroup">
                    <label for="createEmail" class="required">Email</label>
                    <input type="email" id="createEmail" name="email" required>
                    <p class="error-message">This field is required.</p>
                </div>
                <div class="form-group" id="createPasswordGroup">
                    <label for="createPassword" class="required">Password</label>
                    <input type="password" id="createPassword" name="password" required>
                    <p class="error-message">This field is required.</p>
                </div>
                <div class="form-group" id="confirmPasswordGroup">
                    <label for="confirmPassword" class="required">Confirm Password</label>
                    <input type="password" id="confirmPassword" name="confirmPassword" required>
                    <p class="error-message">This field is required.</p>
                </div>
                <button type="submit" class="submit-btn">Create Account</button>
            </form>
        </section>
    </main>

    <footer class="footer">
        <div class="footer-container">
            <div class="footer-column">
                <h3>Brands</h3>
                <ul>
                    <li><a href="brandPage.html?brand=Rick%20Owens">Rick Owens</a></li>
                    <li><a href="brandPage.html?brand=Maison%20Margiela">Maison Margiela</a></li>
                    <li><a href="brandPage.html?brand=Balenciaga">Balenciaga</a></li>
                    <li><a href="brandPage.html?brand=Vivienne%20Westwood">Vivienne Westwood</a></li>
                    <li><a href="brandsPage.html">Other Brands</a></li>
                </ul>
            </div>
            <div class="footer-column">
                <h3>Category</h3>
                <ul>
                    <li><a href="categoryPage.html?category=tops">Tops</a></li>
                    <li><a href="categoryPage.html?category=outerwear">Outerwear</a></li>
                    <li><a href="categoryPage.html?category=bottoms">Bottoms</a></li>
                    <li><a href="categoryPage.html?category=accessories">Accessories</a></li>
                </ul>
            </div>
        </div>
    </footer>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const cartKey = 'fs_cart';

            
            function updateCartCount() {
                const cart = JSON.parse(localStorage.getItem(cartKey)) || [];
                const count = cart.reduce((sum, item) => sum + item.quantity, 0);
                const countEl = document.getElementById('cart-count');
                if (countEl) {
                    countEl.textContent = count > 0 ? count : '';
                }
            }
            
            
            updateCartCount();

            
            if (sessionStorage.getItem('loggedInUser')) {
                window.location.href = 'accountMain.html';
                return; 
            }
            
            
            const utilityLinks = document.getElementById('header-utility-links');
            if (utilityLinks) {
                utilityLinks.innerHTML = '<a href="accountPage.html">Account</a>';
            }

            
            const tabButtons = document.querySelectorAll('.tab-btn');
            const authSections = document.querySelectorAll('.auth-form-section');
            const signInForm = document.getElementById('signInForm');
            const createAccountForm = document.getElementById('createAccountForm');
            const authError = document.getElementById('authError');
            
            const usersStorageKey = 'fs_users'; 

            
            function showAuthError(message) {
                authError.textContent = message;
                authError.style.display = 'block';
            }
            
            
            function hideAuthError() {
                authError.style.display = 'none';
            }

            
            function switchTab(tabId) {
                hideAuthError(); 
                tabButtons.forEach(btn => btn.classList.remove('active'));
                authSections.forEach(sec => sec.classList.remove('active'));

                document.querySelector(`.tab-btn[data-tab="${tabId}"]`).classList.add('active');
                document.getElementById(tabId).classList.add('active');
            }

            
            tabButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const tabId = this.dataset.tab;
                    switchTab(tabId);
                });
            });

            
            function validateForm(form) {
                let isValid = true;
                hideAuthError();
                const requiredInputs = form.querySelectorAll('input[required]');

                requiredInputs.forEach(input => {
                    const formGroup = input.closest('.form-group');
                    if (!input.value.trim()) {
                        formGroup.classList.add('error');
                        isValid = false;
                    } else {
                        formGroup.classList.remove('error');
                    }
                });
                return isValid;
            }

            
            signInForm.addEventListener('submit', function(event) {
                event.preventDefault(); 
                if (!validateForm(this)) {
                    showAuthError('Please fill in all required fields.');
                    return;
                }
                
                const email = document.getElementById('signInEmail').value;
                const password = document.getElementById('signInPassword').value;
                
                const users = JSON.parse(localStorage.getItem(usersStorageKey)) || [];
                
                
                const user = users.find(u => u.email === email && u.password === password);
                
                if (user) {
                    sessionStorage.setItem('loggedInUser', JSON.stringify({ email: user.email, username: user.username }));
                    
                    alert('Sign In successful! Redirecting to your account.');
                    
                    window.location.href = 'accountMain.html';
                } else {
                    
                    showAuthError('Invalid email or password. Please try again.');
                }
            });

            
            createAccountForm.addEventListener('submit', function(event) {
                event.preventDefault(); 
                if (!validateForm(this)) {
                    showAuthError('Please fill in all required fields to create an account.');
                    return;
                }
                
                const username = document.getElementById('createUsername').value;
                const email = document.getElementById('createEmail').value;
                const password = document.getElementById('createPassword').value;
                const confirmPassword = document.getElementById('confirmPassword').value;
                const confirmPasswordGroup = document.getElementById('confirmPasswordGroup');

                
                if (password !== confirmPassword) {
                    confirmPasswordGroup.classList.add('error');
                    confirmPasswordGroup.querySelector('.error-message').textContent = 'Passwords do not match.';
                    showAuthError('Passwords do not match.');
                    return;
                } else {
                    confirmPasswordGroup.classList.remove('error');
                    confirmPasswordGroup.querySelector('.error-message').textContent = 'This field is required.'; // Reset message
                }
                
                
                const users = JSON.parse(localStorage.getItem(usersStorageKey)) || [];
                
                
                if (users.find(u => u.email === email)) {
                    showAuthError('An account with this email already exists. Please sign in.');
                    document.getElementById('createEmailGroup').classList.add('error');
                    return;
                }
                
                
                const newUser = { 
                    username, 
                    email, 
                    password, 
                    wishlist: [], 
                    gameVouchers: 1, 
                    discountVouchers: [],
                    transactions: []  
                };
                
                users.push(newUser);
                localStorage.setItem(usersStorageKey, JSON.stringify(users));
                
                alert('Account created successfully! You have received 1 game voucher. Please sign in.');
                
                
                createAccountForm.reset();
                switchTab('signIn');
                
                document.getElementById('signInEmail').value = email;
            });

            
            const allInputs = document.querySelectorAll('.auth-form-section input');
            allInputs.forEach(input => {
                input.addEventListener('input', function() {
                    const formGroup = this.closest('.form-group');
                    if (formGroup.classList.contains('error')) {
                        formGroup.classList.remove('error');
                    }
                    hideAuthError(); 
                });
            });
        });
    </script>
</body>
</html>